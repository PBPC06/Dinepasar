{% extends 'base.html' %}
{% load static %}

{% block content %}
{% include 'navbar.html' %}
<div class="min-h-screen flex flex-col items-center justify-start py-10 bg-yellow-50"> <!-- Kurangi padding py-5 agar lebih dekat ke navbar -->


    <!-- Updated Greeting Section -->
    <div class="greeting text-center text-3xl font-extrabold text-yellow-600 mb-4">
        HAI! Kamu mau makan apa hari ini?
    </div>

    <!-- Search Bar (With Filter) -->
    <div class="search-bar mt-8 mb-3 w-full flex justify-center"> 
        <form method="POST" class="w-3/4 md:w-2/3 lg:w-1/2 flex">
            {% csrf_token %}
            <input type="text" name="keyword" placeholder="Cari makanan..." class="flex-grow py-2 px-4 rounded-l-lg border border-gray-300">
            <button type="submit" class="bg-yellow-600 text-white py-2 px-4 rounded-r-lg hover:bg-yellow-700">Cari</button>
        </form>
    </div>

    <!-- Filter Section -->
    <form method="POST" class="w-full md:w-3/4 flex justify-center space-x-4 my-4"> <!-- Kurangi margin my-4 -->
        {% csrf_token %}
        <div class="flex items-center space-x-2">
            <label for="kategori" class="text-gray-700">Kategori:</label>
            <select id="kategori" name="kategori" class="border border-gray-300 py-2 px-4 rounded">
                <option value="">Semua Kategori</option>
                <option value="ayam betutu">Ayam Betutu</option>
                <option value="sate">Sate</option>
                <option value="es">Es</option>
                <option value="ayam">Ayam</option>
                <option value="pepes">Pepes</option>
                <option value="nasi">Nasi</option>
                <option value="sayur">Sayur</option>
                <option value="jajanan">Jajanan</option>
                <option value="sambal">Sambal</option>
                <option value="tipat">Tipat</option>
                <option value="rujak">Rujak</option>
                <option value="bebek">Bebek</option>
                <option value="ikan">Ikan</option>
                <option value="kopi">Kopi</option>
                <option value="lawar">Lawar</option>
                <option value="babi guling">Babi Guling</option>
            </select>
        </div>
        <div class="flex items-center space-x-2">
            <label for="harga" class="text-gray-700">Harga:</label>
            <select id="harga" name="harga" class="border border-gray-300 py-2 px-4 rounded">
                <option value="">Semua Harga</option>
                <option value="low">Di bawah Rp50.000</option>
                <option value="medium">Rp50.000 - Rp100.000</option>
                <option value="high">Di atas Rp100.000</option>
            </select>
        </div>
        <button type="submit" class="bg-yellow-600 text-white py-2 px-3 rounded hover:bg-yellow-700">Terapkan Filter</button>
    </form>

    <!-- Add New Food Button -->
    <div class="mt-8 mb-8"> <!-- Kurangi margin mt-8 -->
        <a href="{% url 'search:add_food' %}" class="bg-yellow-600 text-white py-2 px-4 rounded-md hover:bg-yellow-700 transition duration-300">
            + Add New Food
        </a>
    </div>

    <!-- Food Cards -->
    {% if foods %}
    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6 px-4 md:px-16">
        {% for food in foods %}
        <div class="max-w-xs rounded-lg overflow-hidden shadow-lg bg-white hover:shadow-xl transition-shadow duration-300 ease-in-out transform hover:scale-105 flex flex-col justify-between">
            
            <!-- Nama Makanan (Bold) -->
            <div class="p-3 flex-grow">
                <div class="font-bold text-sm mb-2">{{ food.nama_makanan }}</div>
                
                <!-- Gambar -->
                <img class="w-full h-28 object-cover rounded-lg mb-2" src="{{ food.gambar }}" alt="{{ food.nama_makanan }}">

                <!-- Deskripsi Makanan -->
                <p class="text-gray-700 mb-2 text-xs">{{ food.deskripsi|truncatewords:20 }}</p>

                <!-- Rating (Bintang dan Angka) -->
                <div class="flex items-center space-x-2 mb-2">
                    <!-- Bintang -->
                    <img src="{% static 'images/star.png' %}" alt="Star" class="h-4 w-4">
                    <!-- Rating Angka -->
                    <span class="text-gray-700 text-xs">{{ food.rating }} / 5</span>
                </div>

                <!-- Harga (Bold) -->
                <p class="font-bold text-gray-900 text-sm">Rp {{ food.harga }}</p>

            </div>

            <!-- Buttons (Details, Edit, Delete) -->
            <div class="p-4 flex justify-between items-center">

                <!-- Edit and Delete Buttons (Right-aligned) -->
                <div class="flex space-x-2">
                    <!-- Tombol Delete -->
                    <a href="{% url 'search:delete_food' food.id %}" class="bg-[#F44336] hover:bg-[#D32F2F] text-white rounded-full p-2 transition duration-300 shadow-md">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                        </svg>
                    </a>

                    <!-- Tombol Edit -->
                    <a href="{% url 'search:edit_food' food.id %}" class="bg-[#4CAF50] hover:bg-[#388E3C] text-white rounded-full p-2 transition duration-300 shadow-md">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                        </svg>
                    </a>
                </div>


                <!-- Details Button (Left-aligned) -->
                <button onclick="openModal('{{ food.pk }}')" class="bg-yellow-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-yellow-700">Details</button>
            </div>

        </div>
        {% endfor %}
    </div>
{% else %}
    <!-- Section jika tidak ada produk -->
    <div class="flex flex-col justify-center items-center text-center w-full min-h-[50vh] mx-auto">
        <img src="{% static 'images/notfound.png' %}" alt="No Products Available" class="w-48 h-48 mb-4"/>
        <p class="text-gray-600 text-xl mt-4">Maaf, produk yang kamu cari tidak tersedia :(</p>
    </div>
{% endif %}
</div>
{% endblock %}
